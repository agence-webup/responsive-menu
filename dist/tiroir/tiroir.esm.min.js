/*!
 * Tiroir.js v0.1.1
 * (c) 2020-2021 Agence Webup
 * Released under the MIT License.
 */
function t(n){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(n)}function n(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function e(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function r(t,n){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,n){if(t){if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){r&&(t=r);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,u=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return u=t.done,t},e:function(t){s=!0,c=t},f:function(){try{u||null==r.return||r.return()}finally{if(s)throw c}}}}function o(){}function i(t,n){for(const e in n)t[e]=n[e];return t}function c(t){return t()}function u(){return Object.create(null)}function s(t){t.forEach(c)}function a(t){return"function"==typeof t}function l(t,n){return t!=t?n==n:t!==n}function f(t,n){t.appendChild(n)}function h(t,n,e){t.insertBefore(n,e||null)}function d(t){t.parentNode.removeChild(t)}function m(t){return document.createElement(t)}function p(t){return document.createTextNode(t)}function y(){return p(" ")}function v(t,n,e,r){return t.addEventListener(n,e,r),()=>t.removeEventListener(n,e,r)}function b(t,n,e){null==e?t.removeAttribute(n):t.getAttribute(n)!==e&&t.setAttribute(n,e)}function g(t,n){const e=Object.getOwnPropertyDescriptors(t.__proto__);for(const r in n)null==n[r]?t.removeAttribute(r):"style"===r?t.style.cssText=n[r]:"__value"===r?t.value=t[r]=n[r]:e[r]&&e[r].set?t[r]=n[r]:b(t,r,n[r])}function _(t,n){n=""+n,t.wholeText!==n&&(t.data=n)}let $;function E(t){$=t}function L(){const t=function(){if(!$)throw new Error("Function called outside component initialization");return $}();return(n,e)=>{const r=t.$$.callbacks[n];if(r){const o=function(t,n){const e=document.createEvent("CustomEvent");return e.initCustomEvent(t,!1,!1,n),e}(n,e);r.slice().forEach((n=>{n.call(t,o)}))}}}const w=[],k=[],C=[],j=[],A=Promise.resolve();let O=!1;function x(t){C.push(t)}let S=!1;const N=new Set;function T(){if(!S){S=!0;do{for(let t=0;t<w.length;t+=1){const n=w[t];E(n),I(n.$$)}for(E(null),w.length=0;k.length;)k.pop()();for(let t=0;t<C.length;t+=1){const n=C[t];N.has(n)||(N.add(n),n())}C.length=0}while(w.length);for(;j.length;)j.pop()();O=!1,S=!1,N.clear()}}function I(t){if(null!==t.fragment){t.update(),s(t.before_update);const n=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,n),t.after_update.forEach(x)}}const M=new Set;function D(t,n){const e={},r={},o={$$scope:1};let i=t.length;for(;i--;){const c=t[i],u=n[i];if(u){for(const t in c)t in u||(r[t]=1);for(const t in u)o[t]||(e[t]=u[t],o[t]=1);t[i]=u}else for(const t in c)o[t]=1}for(const t in r)t in e||(e[t]=void 0);return e}function q(t,n){-1===t.$$.dirty[0]&&(w.push(t),O||(O=!0,A.then(T)),t.$$.dirty.fill(0)),t.$$.dirty[n/31|0]|=1<<n%31}function z(t,n,e,r,i,l,f=[-1]){const h=$;E(t);const m=n.props||{},p=t.$$={fragment:null,ctx:null,props:l,update:o,not_equal:i,bound:u(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(h?h.$$.context:[]),callbacks:u(),dirty:f,skip_bound:!1};let y=!1;if(p.ctx=e?e(t,m,((n,e,...r)=>{const o=r.length?r[0]:e;return p.ctx&&i(p.ctx[n],p.ctx[n]=o)&&(!p.skip_bound&&p.bound[n]&&p.bound[n](o),y&&q(t,n)),e})):[],p.update(),y=!0,s(p.before_update),p.fragment=!!r&&r(p.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);p.fragment&&p.fragment.l(t),t.forEach(d)}else p.fragment&&p.fragment.c();n.intro&&((v=t.$$.fragment)&&v.i&&(M.delete(v),v.i(b))),function(t,n,e){const{fragment:r,on_mount:o,on_destroy:i,after_update:u}=t.$$;r&&r.m(n,e),x((()=>{const n=o.map(c).filter(a);i?i.push(...n):s(n),t.$$.on_mount=[]})),u.forEach(x)}(t,n.target,n.anchor),T()}var v,b;E(h)}function H(t,n,e){const r=t.slice();return r[11]=n[e],r[13]=e,r}function P(t){let n,e,r,o,i,c,u,a,l,g=t[2].label+"",$=t[2].link&&X(t);return{c(){n=m("button"),e=p(t[0]),r=y(),o=m("button"),i=p(g),c=y(),$&&$.c(),u=p(""),b(n,"class","tiroirjs__reset"),b(n,"type","button"),b(o,"class","tiroirjs__back"),b(o,"type","button")},m(s,d){h(s,n,d),f(n,e),h(s,r,d),h(s,o,d),f(o,i),h(s,c,d),$&&$.m(s,d),h(s,u,d),a||(l=[v(n,"click",t[6]),v(o,"click",t[4])],a=!0)},p(t,n){1&n&&_(e,t[0]),4&n&&g!==(g=t[2].label+"")&&_(i,g),t[2].link?$?$.p(t,n):($=X(t),$.c(),$.m(u.parentNode,u)):$&&($.d(1),$=null)},d(t){t&&d(n),t&&d(r),t&&d(o),t&&d(c),$&&$.d(t),t&&d(u),a=!1,s(l)}}}function X(t){let n,e,r,o,c,u=t[2].label+"",s=[{class:"tiroirjs__current"},{href:c=t[2].link},t[2].attributes],a={};for(let t=0;t<s.length;t+=1)a=i(a,s[t]);return{c(){n=m("a"),e=p(t[1]),r=y(),o=p(u),g(n,a)},m(t,i){h(t,n,i),f(n,e),f(n,r),f(n,o)},p(t,r){2&r&&_(e,t[1]),4&r&&u!==(u=t[2].label+"")&&_(o,u),g(n,a=D(s,[{class:"tiroirjs__current"},4&r&&c!==(c=t[2].link)&&{href:c},4&r&&t[2].attributes]))},d(t){t&&d(n)}}}function U(t){let n,e,r,o=t[11].label+"",c=[{class:"tiroirjs__navItem"},{href:r=t[11].link},t[11].attributes],u={};for(let t=0;t<c.length;t+=1)u=i(u,c[t]);return{c(){n=m("a"),e=p(o),g(n,u)},m(t,r){h(t,n,r),f(n,e)},p(t,i){8&i&&o!==(o=t[11].label+"")&&_(e,o),g(n,u=D(c,[{class:"tiroirjs__navItem"},8&i&&r!==(r=t[11].link)&&{href:r},8&i&&t[11].attributes]))},d(t){t&&d(n)}}}function B(t){let n,e,r,o,c=t[11].label+"",u=[{class:"tiroirjs__navItem"},{type:"button"},t[11].attributes],s={};for(let t=0;t<u.length;t+=1)s=i(s,u[t]);function a(){return t[9](t[13])}return{c(){n=m("button"),e=p(c),g(n,s)},m(t,i){h(t,n,i),f(n,e),r||(o=v(n,"click",a),r=!0)},p(r,o){t=r,8&o&&c!==(c=t[11].label+"")&&_(e,c),g(n,s=D(u,[{class:"tiroirjs__navItem"},{type:"button"},8&o&&t[11].attributes]))},d(t){t&&d(n),r=!1,o()}}}function F(t){let n,e;function r(t,n){return t[11].items?B:U}let o=r(t),i=o(t);return{c(){n=m("li"),i.c(),e=y()},m(t,r){h(t,n,r),i.m(n,null),f(n,e)},p(t,c){o===(o=r(t))&&i?i.p(t,c):(i.d(1),i=o(t),i&&(i.c(),i.m(n,e)))},d(t){t&&d(n),i.d()}}}function V(t){let n,e,r,i=t[2]&&P(t),c=t[3],u=[];for(let n=0;n<c.length;n+=1)u[n]=F(H(t,c,n));return{c(){n=m("div"),i&&i.c(),e=y(),r=m("ul");for(let t=0;t<u.length;t+=1)u[t].c();b(r,"class","tiroirjs__navList")},m(t,o){h(t,n,o),i&&i.m(n,null),f(n,e),f(n,r);for(let t=0;t<u.length;t+=1)u[t].m(r,null)},p(t,[o]){if(t[2]?i?i.p(t,o):(i=P(t),i.c(),i.m(n,e)):i&&(i.d(1),i=null),40&o){let n;for(c=t[3],n=0;n<c.length;n+=1){const e=H(t,c,n);u[n]?u[n].p(e,o):(u[n]=F(e),u[n].c(),u[n].m(r,null))}for(;n<u.length;n+=1)u[n].d(1);u.length=c.length}},i:o,o:o,d(t){t&&d(n),i&&i.d(),function(t,n){for(let e=0;e<t.length;e+=1)t[e]&&t[e].d(n)}(u,t)}}}function R(t,n,e){let r,o;const i=L();let{resetLabel:c}=n,{currentLabel:u}=n,{items:s=[]}=n,a=[];const l=t=>{e(8,a=[...a,t])};return t.$$set=t=>{"resetLabel"in t&&e(0,c=t.resetLabel),"currentLabel"in t&&e(1,u=t.currentLabel),"items"in t&&e(7,s=t.items)},t.$$.update=()=>{384&t.$$.dirty&&e(2,r=0===a.length?null:a.reduce(((t,n)=>t.items[n]),{items:s})),132&t.$$.dirty&&e(3,o=r?r.items:s),256&t.$$.dirty&&i("level",a.length)},[c,u,r,o,()=>{e(8,a=a.slice(0,-1))},l,()=>{e(8,a=[])},s,a,t=>l(t)]}class G extends class{$destroy(){!function(t,n){const e=t.$$;null!==e.fragment&&(s(e.on_destroy),e.fragment&&e.fragment.d(n),e.on_destroy=e.fragment=null,e.ctx=[])}(this,1),this.$destroy=o}$on(t,n){const e=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return e.push(n),()=>{const t=e.indexOf(n);-1!==t&&e.splice(t,1)}}$set(t){var n;this.$$set&&(n=t,0!==Object.keys(n).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),z(this,t,R,V,l,{resetLabel:0,currentLabel:1,items:7})}}var J,K,Q,W,Y=function(t){return t},Z=function(t){return t.reduceRight((function(t,n){return n(t)}),Y)},tt=function(t){return function(n){return null==n?null:t(n)}},nt=function(n){return function(e){return function(r){if(t(r)===n)return e(r);throw new Error("".concat(t(r)," is not a type ").concat(n))}}},et=(J=HTMLElement,function(t){return function(n){if(n instanceof J)return t(n);throw new Error("".concat(n.constructor.name," is not an instance of ").concat(J.name))}}),rt=Z([function(n){return function(e){if(null!=e)return n(e);throw new Error("".concat(t(e)," is required"))}},et]),ot=Z([tt,function(t){return function(n){var e=Array.isArray(n)?n:n instanceof NodeList||n instanceof HTMLCollection?Array.from(n):[n];return t(e.map(Z([et])))}}]),it=Z([tt,nt("function")]),ct=(Z([tt,nt("string")]),function(t,n){return Z([(e=n,function(t){return function(n){return t(null==n?e:n)}}),nt("string")])(t);var e}),ut=function(t){return t.nodeType===Node.ELEMENT_NODE},st=function(t){return t.nodeType===Node.TEXT_NODE},at=function(t){return function(n){return ut(n)&&n.nodeName===t}},lt=at("UL"),ft=at("LI"),ht=at("A"),dt=at("BUTTON"),mt=function(t,n){return Object.fromEntries(Array.from(n).filter((function(n){return!t.includes(n.name)})).map((function(t){return[t.name,t.nodeValue]})))},pt=function(t){if(ft(t)){var n=Array.from(t.childNodes),e=n.find(lt),r=n.find(ht),o=n.find(dt);if(!e&&!r)throw new Error("Invalid item : children does not have ul or a");return{items:e?yt(e):null,link:r?r.href:null,label:r||o?(r||o).textContent:n.filter(st).reduce((function(t,n){return t+n.nodeValue}),""),attributes:r?mt(["href"],r.attributes):o?mt(["type"],o.attributes):{}}}throw new Error("Invalid item : node is not a li ")},yt=function(t){if(lt(t))return Array.from(t.childNodes).filter(ut).map(pt);throw new Error("Invalid list : node is not a ul")},vt=function(){function t(n){var e=this;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.target=rt(n.target),this.trigger=ot(n.trigger),this.onOpen=it(n.onOpen),this.onClose=it(n.onClose),this.resetLabel=ct(n.resetLabel,"Home"),this.currentLabel=ct(n.currentLabel,"All"),this.overlay=n.target.querySelector(".tiroirjs__overlay"),this.menuContainer=n.target.querySelector(".tiroirjs__menu"),this.direction=this.menuContainer.classList.contains("tiroirjs__menu--left"),this.startDistance=0,this.distance=0;var r=this.target.querySelector(".tiroirjs__nav"),o=[],i=document.createElement("div");i.classList.add("tiroirjs__nav"),r?(o=function(t){if(lt(t))return yt(t);var n=Array.from(t.childNodes);if(n.some(lt))return yt(n.find(lt));throw new Error("Invalid content : node have no ul child")}(r),r.parentNode.replaceChild(i,r)):this.menuContainer.prepend(i),this.menu=new G({target:n.target.querySelector(".tiroirjs__nav"),props:{items:o,resetLabel:this.resetLabel,currentLabel:this.currentLabel}}),this.menu.$on("level",(function(t){console.log(t.detail)})),this.trigger&&this.trigger.forEach((function(t){t.addEventListener("click",(function(){e.toggle()}))})),this.overlay&&this.overlay.addEventListener("click",(function(t){t.preventDefault(),t.stopPropagation(),e.close()}),!1),document.addEventListener("touchstart",(function(t){e._touchStart(t)}),!1),document.addEventListener("touchmove",(function(t){e._touchMove(t)}),!1),document.addEventListener("touchend",(function(t){e._touchEnd(t)}),!1)}var e,o,i;return e=t,(o=[{key:"_normalizeElement",value:function(t){if(t instanceof HTMLElement)return t;throw new Error(t.constructor.name+" is not an html element")}},{key:"_normalizeSelector",value:function(t){var n,e=function(){switch(!0){case Array.isArray(t):return t;case t instanceof NodeList||t instanceof HTMLCollection:return Array.from(t);default:return[t]}}(),o=r(e);try{for(o.s();!(n=o.n()).done;){var i=n.value;this._normalizeElement(i)}}catch(t){o.e(t)}finally{o.f()}return e}},{key:"_normalizeFunction",value:function(t){if("function"==typeof t)return t;throw new Error(t.constructor.name+" is not an valid function")}},{key:"_transitionEnd",value:function(){this.isOpen()||this.close()}},{key:"_touchStart",value:function(t){this.isOpen()&&(this.startDistance=t.touches[0].pageX)}},{key:"_touchMove",value:function(t){this.isOpen()&&(this.distance=(this.direction?Math.min:Math.max)(0,t.touches[0].pageX-this.startDistance),this.menuContainer.style.transform="translateX("+this.distance+"px)")}},{key:"_touchEnd",value:function(){this.isOpen()&&(Math.abs(this.distance)>70?this.close():this.menuContainer.style.transform=null)}},{key:"open",value:function(){this.overlay.classList.add(this.constructor.activeClass),this.menuContainer.classList.add(this.constructor.activeClass),this.onOpen&&this.onOpen()}},{key:"close",value:function(){this.menuContainer.style.transform=null,this.overlay.classList.remove(this.constructor.activeClass),this.menuContainer.classList.remove(this.constructor.activeClass),this.onClose&&this.onClose()}},{key:"isOpen",value:function(){return this.menuContainer.classList.contains(this.constructor.activeClass)}},{key:"toggle",value:function(){this.isOpen()?this.close():this.open()}},{key:"setItems",value:function(t){this.menu.$set({items:t})}}])&&n(e.prototype,o),i&&n(e,i),t}();W="active",(Q="activeClass")in(K=vt)?Object.defineProperty(K,Q,{value:W,enumerable:!0,configurable:!0,writable:!0}):K[Q]=W;export default vt;
