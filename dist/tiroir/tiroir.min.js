/*!
 * Tiroir.js v0.1.0
 * (c) 2020-2021 Agence Webup
 * Released under the MIT License.
 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t="undefined"!=typeof globalThis?globalThis:t||self).Tiroir=n()}(this,(function(){"use strict";function t(n){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(n)}function n(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function e(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function r(t,n){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,n){if(t){if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){r&&(t=r);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,c=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return c=t.done,t},e:function(t){s=!0,u=t},f:function(){try{c||null==r.return||r.return()}finally{if(s)throw u}}}}function o(){}function i(t,n){for(const e in n)t[e]=n[e];return t}function u(t){return t()}function c(){return Object.create(null)}function s(t){t.forEach(u)}function l(t){return"function"==typeof t}function a(t,n){return t!=t?n==n:t!==n}function f(t,n){t.appendChild(n)}function d(t,n,e){t.insertBefore(n,e||null)}function h(t){t.parentNode.removeChild(t)}function m(t){return document.createElement(t)}function p(t){return document.createTextNode(t)}function y(){return p(" ")}function v(t,n,e,r){return t.addEventListener(n,e,r),()=>t.removeEventListener(n,e,r)}function b(t,n,e){null==e?t.removeAttribute(n):t.getAttribute(n)!==e&&t.setAttribute(n,e)}function g(t,n){const e=Object.getOwnPropertyDescriptors(t.__proto__);for(const r in n)null==n[r]?t.removeAttribute(r):"style"===r?t.style.cssText=n[r]:"__value"===r?t.value=t[r]=n[r]:e[r]&&e[r].set?t[r]=n[r]:b(t,r,n[r])}function $(t,n){n=""+n,t.wholeText!==n&&(t.data=n)}let _;function E(t){_=t}function w(){const t=function(){if(!_)throw new Error("Function called outside component initialization");return _}();return(n,e)=>{const r=t.$$.callbacks[n];if(r){const o=function(t,n){const e=document.createEvent("CustomEvent");return e.initCustomEvent(t,!1,!1,n),e}(n,e);r.slice().forEach((n=>{n.call(t,o)}))}}}const k=[],L=[],C=[],A=[],O=Promise.resolve();let x=!1;function S(t){C.push(t)}let T=!1;const j=new Set;function N(){if(!T){T=!0;do{for(let t=0;t<k.length;t+=1){const n=k[t];E(n),M(n.$$)}for(E(null),k.length=0;L.length;)L.pop()();for(let t=0;t<C.length;t+=1){const n=C[t];j.has(n)||(j.add(n),n())}C.length=0}while(k.length);for(;A.length;)A.pop()();x=!1,T=!1,j.clear()}}function M(t){if(null!==t.fragment){t.update(),s(t.before_update);const n=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,n),t.after_update.forEach(S)}}const I=new Set;function D(t,n){const e={},r={},o={$$scope:1};let i=t.length;for(;i--;){const u=t[i],c=n[i];if(c){for(const t in u)t in c||(r[t]=1);for(const t in c)o[t]||(e[t]=c[t],o[t]=1);t[i]=c}else for(const t in u)o[t]=1}for(const t in r)t in e||(e[t]=void 0);return e}function q(t,n){-1===t.$$.dirty[0]&&(k.push(t),x||(x=!0,O.then(N)),t.$$.dirty.fill(0)),t.$$.dirty[n/31|0]|=1<<n%31}function z(t,n,e,r,i,a,f=[-1]){const d=_;E(t);const m=n.props||{},p=t.$$={fragment:null,ctx:null,props:a,update:o,not_equal:i,bound:c(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:[]),callbacks:c(),dirty:f,skip_bound:!1};let y=!1;if(p.ctx=e?e(t,m,((n,e,...r)=>{const o=r.length?r[0]:e;return p.ctx&&i(p.ctx[n],p.ctx[n]=o)&&(!p.skip_bound&&p.bound[n]&&p.bound[n](o),y&&q(t,n)),e})):[],p.update(),y=!0,s(p.before_update),p.fragment=!!r&&r(p.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);p.fragment&&p.fragment.l(t),t.forEach(h)}else p.fragment&&p.fragment.c();n.intro&&((v=t.$$.fragment)&&v.i&&(I.delete(v),v.i(b))),function(t,n,e){const{fragment:r,on_mount:o,on_destroy:i,after_update:c}=t.$$;r&&r.m(n,e),S((()=>{const n=o.map(u).filter(l);i?i.push(...n):s(n),t.$$.on_mount=[]})),c.forEach(S)}(t,n.target,n.anchor),N()}var v,b;E(d)}function H(t,n,e){const r=t.slice();return r[10]=n[e],r[12]=e,r}function P(t){let n,e,r,o,i,u,c,l,a,g=t[1].label+"",_=t[1].link&&X(t);return{c(){n=m("button"),e=p(t[0]),r=y(),o=m("button"),i=p(g),u=y(),_&&_.c(),c=p(""),b(n,"type","button"),b(o,"type","button")},m(s,h){d(s,n,h),f(n,e),d(s,r,h),d(s,o,h),f(o,i),d(s,u,h),_&&_.m(s,h),d(s,c,h),l||(a=[v(n,"click",t[5]),v(o,"click",t[3])],l=!0)},p(t,n){1&n&&$(e,t[0]),2&n&&g!==(g=t[1].label+"")&&$(i,g),t[1].link?_?_.p(t,n):(_=X(t),_.c(),_.m(c.parentNode,c)):_&&(_.d(1),_=null)},d(t){t&&h(n),t&&h(r),t&&h(o),t&&h(u),_&&_.d(t),t&&h(c),l=!1,s(a)}}}function X(t){let n,e,r,o,u=t[1].label+"",c=[{href:o=t[1].link},t[1].attributes],s={};for(let t=0;t<c.length;t+=1)s=i(s,c[t]);return{c(){n=m("a"),e=p("All "),r=p(u),g(n,s)},m(t,o){d(t,n,o),f(n,e),f(n,r)},p(t,e){2&e&&u!==(u=t[1].label+"")&&$(r,u),g(n,s=D(c,[2&e&&o!==(o=t[1].link)&&{href:o},2&e&&t[1].attributes]))},d(t){t&&h(n)}}}function U(t){let n,e,r,o=t[10].label+"",u=[{class:"tiroirjs__navItem"},{href:r=t[10].link},t[10].attributes],c={};for(let t=0;t<u.length;t+=1)c=i(c,u[t]);return{c(){n=m("a"),e=p(o),g(n,c)},m(t,r){d(t,n,r),f(n,e)},p(t,i){4&i&&o!==(o=t[10].label+"")&&$(e,o),g(n,c=D(u,[{class:"tiroirjs__navItem"},4&i&&r!==(r=t[10].link)&&{href:r},4&i&&t[10].attributes]))},d(t){t&&h(n)}}}function B(t){let n,e,r,o,u=t[10].label+"",c=[{type:"button"},t[10].attributes],s={};for(let t=0;t<c.length;t+=1)s=i(s,c[t]);function l(){return t[8](t[12])}return{c(){n=m("button"),e=p(u),g(n,s)},m(t,i){d(t,n,i),f(n,e),r||(o=v(n,"click",l),r=!0)},p(r,o){t=r,4&o&&u!==(u=t[10].label+"")&&$(e,u),g(n,s=D(c,[{type:"button"},4&o&&t[10].attributes]))},d(t){t&&h(n),r=!1,o()}}}function F(t){let n,e;function r(t,n){return t[10].items?B:U}let o=r(t),i=o(t);return{c(){n=m("li"),i.c(),e=y()},m(t,r){d(t,n,r),i.m(n,null),f(n,e)},p(t,u){o===(o=r(t))&&i?i.p(t,u):(i.d(1),i=o(t),i&&(i.c(),i.m(n,e)))},d(t){t&&h(n),i.d()}}}function V(t){let n,e,r,i=t[1]&&P(t),u=t[2],c=[];for(let n=0;n<u.length;n+=1)c[n]=F(H(t,u,n));return{c(){n=m("div"),i&&i.c(),e=y(),r=m("ul");for(let t=0;t<c.length;t+=1)c[t].c()},m(t,o){d(t,n,o),i&&i.m(n,null),f(n,e),f(n,r);for(let t=0;t<c.length;t+=1)c[t].m(r,null)},p(t,[o]){if(t[1]?i?i.p(t,o):(i=P(t),i.c(),i.m(n,e)):i&&(i.d(1),i=null),20&o){let n;for(u=t[2],n=0;n<u.length;n+=1){const e=H(t,u,n);c[n]?c[n].p(e,o):(c[n]=F(e),c[n].c(),c[n].m(r,null))}for(;n<c.length;n+=1)c[n].d(1);c.length=u.length}},i:o,o:o,d(t){t&&h(n),i&&i.d(),function(t,n){for(let e=0;e<t.length;e+=1)t[e]&&t[e].d(n)}(c,t)}}}function R(t,n,e){let r,o;const i=w();let{resetLabel:u}=n,{items:c=[]}=n,s=[];const l=t=>{e(7,s=[...s,t])};return t.$$set=t=>{"resetLabel"in t&&e(0,u=t.resetLabel),"items"in t&&e(6,c=t.items)},t.$$.update=()=>{192&t.$$.dirty&&e(1,r=0===s.length?null:s.reduce(((t,n)=>t.items[n]),{items:c})),66&t.$$.dirty&&e(2,o=r?r.items:c),128&t.$$.dirty&&i("level",s.length)},[u,r,o,()=>{e(7,s=s.slice(0,-1))},l,()=>{e(7,s=[])},c,s,t=>l(t)]}class G extends class{$destroy(){!function(t,n){const e=t.$$;null!==e.fragment&&(s(e.on_destroy),e.fragment&&e.fragment.d(n),e.on_destroy=e.fragment=null,e.ctx=[])}(this,1),this.$destroy=o}$on(t,n){const e=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return e.push(n),()=>{const t=e.indexOf(n);-1!==t&&e.splice(t,1)}}$set(t){var n;this.$$set&&(n=t,0!==Object.keys(n).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),z(this,t,R,V,a,{resetLabel:0,items:6})}}var J,K,Q,W,Y=function(t){return t},Z=function(t){return t.reduceRight((function(t,n){return n(t)}),Y)},tt=function(t){return function(n){return null==n?null:t(n)}},nt=function(n){return function(e){return function(r){if(t(r)===n)return e(r);throw new Error("".concat(t(r)," is not a type ").concat(n))}}},et=(J=HTMLElement,function(t){return function(n){if(n instanceof J)return t(n);throw new Error("".concat(n.constructor.name," is not an instance of ").concat(J.name))}}),rt=Z([function(n){return function(e){if(null!=e)return n(e);throw new Error("".concat(t(e)," is required"))}},et]),ot=Z([tt,function(t){return function(n){var e=Array.isArray(n)?n:n instanceof NodeList||n instanceof HTMLCollection?Array.from(n):[n];return t(e.map(Z([et])))}}]),it=Z([tt,nt("function")]),ut=(Z([tt,nt("string")]),function(t){return t.nodeType===Node.ELEMENT_NODE}),ct=function(t){return t.nodeType===Node.TEXT_NODE},st=function(t){return function(n){return ut(n)&&n.nodeName===t}},lt=st("UL"),at=st("LI"),ft=st("A"),dt=st("BUTTON"),ht=function(t,n){return Object.fromEntries(Array.from(n).filter((function(n){return!t.includes(n.name)})).map((function(t){return[t.name,t.nodeValue]})))},mt=function(t){if(at(t)){var n=Array.from(t.childNodes),e=n.find(lt),r=n.find(ft),o=n.find(dt);if(!e&&!r)throw new Error("Invalid item : children does not have ul or a");return{items:e?pt(e):null,link:r?r.href:null,label:r||o?(r||o).textContent:n.filter(ct).reduce((function(t,n){return t+n.nodeValue}),""),attributes:r?ht(["href"],r.attributes):o?ht(["type"],o.attributes):{}}}throw new Error("Invalid item : node is not a li ")},pt=function(t){if(lt(t))return Array.from(t.childNodes).filter(ut).map(mt);throw new Error("Invalid list : node is not a ul")},yt=function(){function t(n){var e,r,o=this;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.target=rt(n.target),this.trigger=ot(n.trigger),this.onOpen=it(n.onOpen),this.onClose=it(n.onClose),this.resetLabel=(e=n.resetLabel,Z([(r="Home",function(t){return function(n){return t(null==n?r:n)}}),nt("string")])(e)),this.overlay=n.target.querySelector(".tiroirjs__overlay"),this.menuContainer=n.target.querySelector(".tiroirjs__menu"),this.direction=this.menuContainer.classList.contains("tiroirjs__menu--left"),this.startDistance=0,this.distance=0;var i=this.target.querySelector(".tiroirjs__nav"),u=[],c=document.createElement("div");c.classList.add("tiroirjs__nav"),i?(u=function(t){if(lt(t))return pt(t);var n=Array.from(t.childNodes);if(n.some(lt))return pt(n.find(lt));throw new Error("Invalid content : node have no ul child")}(i),i.parentNode.replaceChild(c,i)):this.menuContainer.prepend(c),this.menu=new G({target:n.target.querySelector(".tiroirjs__nav"),props:{items:u,resetLabel:this.resetLabel}}),this.menu.$on("level",(function(t){console.log(t.detail)})),this.trigger&&this.trigger.forEach((function(t){t.addEventListener("click",(function(){o.toggle()}))})),this.overlay&&this.overlay.addEventListener("click",(function(t){t.preventDefault(),t.stopPropagation(),o.close()}),!1),document.addEventListener("touchstart",(function(t){o._touchStart(t)}),!1),document.addEventListener("touchmove",(function(t){o._touchMove(t)}),!1),document.addEventListener("touchend",(function(t){o._touchEnd(t)}),!1)}var e,o,i;return e=t,(o=[{key:"_normalizeElement",value:function(t){if(t instanceof HTMLElement)return t;throw new Error(t.constructor.name+" is not an html element")}},{key:"_normalizeSelector",value:function(t){var n,e=function(){switch(!0){case Array.isArray(t):return t;case t instanceof NodeList||t instanceof HTMLCollection:return Array.from(t);default:return[t]}}(),o=r(e);try{for(o.s();!(n=o.n()).done;){var i=n.value;this._normalizeElement(i)}}catch(t){o.e(t)}finally{o.f()}return e}},{key:"_normalizeFunction",value:function(t){if("function"==typeof t)return t;throw new Error(t.constructor.name+" is not an valid function")}},{key:"_transitionEnd",value:function(){this.isOpen()||this.close()}},{key:"_touchStart",value:function(t){this.isOpen()&&(this.startDistance=t.touches[0].pageX)}},{key:"_touchMove",value:function(t){this.isOpen()&&(this.distance=(this.direction?Math.min:Math.max)(0,t.touches[0].pageX-this.startDistance),this.menuContainer.style.transform="translateX("+this.distance+"px)")}},{key:"_touchEnd",value:function(){this.isOpen()&&(Math.abs(this.distance)>70?this.close():this.menuContainer.style.transform=null)}},{key:"open",value:function(){this.overlay.classList.add(this.constructor.activeClass),this.menuContainer.classList.add(this.constructor.activeClass),this.onOpen&&this.onOpen()}},{key:"close",value:function(){this.menuContainer.style.transform=null,this.overlay.classList.remove(this.constructor.activeClass),this.menuContainer.classList.remove(this.constructor.activeClass),this.onClose&&this.onClose()}},{key:"isOpen",value:function(){return this.menuContainer.classList.contains(this.constructor.activeClass)}},{key:"toggle",value:function(){this.isOpen()?this.close():this.open()}},{key:"setItems",value:function(t){this.menu.$set({items:t})}}])&&n(e.prototype,o),i&&n(e,i),t}();return W="active",(Q="activeClass")in(K=yt)?Object.defineProperty(K,Q,{value:W,enumerable:!0,configurable:!0,writable:!0}):K[Q]=W,yt}));
